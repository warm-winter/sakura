## 8.1 虚拟存储的需求背景

![image-20200814172526525](C:\Users\YCNN\AppData\Roaming\Typora\typora-user-images\image-20200814172526525.png)


计算机系统时常出现内存空间不够用

* 覆盖( overlay )
  应用程序手动把需要的指令和数据保存在内存中
* 交换( swapping )
  操作系统自动把暂时不能执行的程序保存到外存中
* 虚拟存储
  在有限容量的内存中,以页为单位自动装入更多更大的程序

## 8.2覆盖和交换

### 覆盖技术



#### 目标

情况：一个程序应用空间不够使用

在较小的可用内存中运行较大的程序

#### 方法

依据程序逻辑结构,将程序划分为若干功能相对独立的模块;将**不会同时执行**的模块**共享同一块**内存区域

* 必要部分(常用功能)的代码和数据常驻内存
* 可选部分(不常用功能)放在其他程序模块中,只在需要用到时装入内存
* 不存在调用关系的模块可相互覆盖,共用同一块内存区域

#### 缺点

##### 增加编程困难

需程序员划分功能模块,并确定模块间的覆盖关系
增加了编程的复杂度;

##### 增加执行时间

从外存装入覆盖模块
时间换空间

### 交换技术

#### 目标

情况：多个程序，有一个程序塞不下了

增加正运行或需要运行的程序的内存

#### 实现方法

可将暂时不能运行的程序放到外存

换入换出的基本单位：整个进程的地址空间

* 换出(swap out )
  把一个进程的整个地址空间保存到外存
* 换入(swap in)
  将外存中某进程的地址空间读入到内存

#### 问题

（1）交换时机何时需要发生交换?
只当内存空间不够或有不够的可能时换出
（2）交换区大小
存放所有用户进程的所有内存映像的拷贝
（3）程序换入时的重定位:换出后再换入时要放
（4）在原处吗?
采用动态地址映射的方法

### 覆盖与交换的比较
#### 覆盖
* 只能发生在没有调用关系的模块间
* 程序员须给出模块间的逻辑覆盖结构
* 发生在运行程序的内部模块间

#### 交换

* 以进程为单位
* D不需要模块间的逻辑覆盖结构
* 发生在内存进程间

## 8.3 局部性原理